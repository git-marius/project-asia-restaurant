{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="mx-auto max-w-7xl px-4 py-6">
    <div class="flex gap-6">

        <!-- Sidebar -->
        <aside class="hidden w-64 shrink-0 lg:block">
            <div class="sticky top-6 space-y-4">
                <div>
                    <div class="text-lg font-semibold tracking-tight">Mitarbeiter-Dashboard</div>
                </div>

                <nav class="space-y-1 rounded-2xl border border-white/10 bg-white/5 p-2">
                    <button class="nav-btn flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm font-medium"
                        data-view="dashboard">
                        <span class="opacity-80">üìä</span> Dashboard
                    </button>
                    <button class="nav-btn flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm font-medium"
                        data-view="regression">
                        <span class="opacity-80">üßÆ</span> Regression
                    </button>
                </nav>

                <div class="rounded-2xl border border-white/10 bg-white/5 p-4">
                    <div class="text-sm text-neutral-400">Letztes Update</div>
                    <div id="top-last-update" class="mt-1 text-sm font-medium text-neutral-200">‚Äì</div>

                    <button id="btnRefresh"
                        class="mt-3 w-full rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-medium text-neutral-200 hover:bg-white/10">
                        Aktualisieren
                    </button>

                    <div
                        class="mt-3 inline-flex items-center gap-2 rounded-full border border-white/10 bg-black/20 px-3 py-1 text-xs text-neutral-300">
                        <span class="h-2 w-2 rounded-full bg-emerald-400"></span>
                        Auto-Refresh 30s
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main -->
        <main class="min-w-0 flex-1">

            <!-- Topbar -->
            <div class="mb-5 flex flex-wrap items-end justify-between gap-3">
                <div>
                    <h1 id="viewTitle" class="text-2xl font-semibold tracking-tight">Dashboard</h1>
                </div>

                <div class="flex w-full items-center gap-2 lg:w-auto">
                    <!-- Mobile nav -->
                    <div
                        class="inline-flex w-full flex-wrap gap-1 rounded-2xl border border-white/10 bg-white/5 p-1 lg:hidden">
                        <button class="nav-btn rounded-xl px-4 py-2 text-sm font-medium"
                            data-view="dashboard">Dashboard</button>
                        <button class="nav-btn rounded-xl px-4 py-2 text-sm font-medium"
                            data-view="regression">Regression</button>
                    </div>

                    <button id="btnRefreshTop"
                        class="hidden rounded-xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-medium text-neutral-200 hover:bg-white/10 lg:inline-flex">
                        Aktualisieren
                    </button>
                </div>
            </div>

            <!-- VIEW: DASHBOARD -->
            <section data-panel="dashboard">
                <div class="grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4">
                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5">
                        <div class="flex items-start justify-between gap-4">
                            <div>
                                <div class="text-sm text-neutral-400">Temperatur</div>
                                <div class="mt-2 text-3xl font-semibold tracking-tight" id="kpi-temp">‚Äì</div>
                                <div class="mt-2 text-sm text-neutral-400" id="kpi-ts">‚Äì</div>
                            </div>
                            <div
                                class="grid h-11 w-11 place-items-center rounded-2xl border border-white/10 bg-white/5">
                                üå°Ô∏è</div>
                        </div>
                    </div>

                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5">
                        <div class="flex items-start justify-between gap-4">
                            <div>
                                <div class="text-sm text-neutral-400">Luftfeuchtigkeit</div>
                                <div class="mt-2 flex items-baseline gap-2">
                                    <div class="text-3xl font-semibold tracking-tight" id="kpi-hum">‚Äì</div>
                                    <div class="text-sm text-neutral-400">%</div>
                                </div>
                                <div class="mt-2 text-sm text-neutral-400">Aktuell</div>
                            </div>
                            <div
                                class="grid h-11 w-11 place-items-center rounded-2xl border border-white/10 bg-white/5">
                                üíß</div>
                        </div>
                    </div>

                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5">
                        <div class="flex items-start justify-between gap-4">
                            <div>
                                <div class="text-sm text-neutral-400">VOC</div>
                                <div class="mt-2 text-3xl font-semibold tracking-tight" id="kpi-voc">‚Äì</div>
                                <div class="mt-2 text-sm text-neutral-400">ppm / raw</div>
                            </div>
                            <div
                                class="grid h-11 w-11 place-items-center rounded-2xl border border-white/10 bg-white/5">
                                üß™</div>
                        </div>
                    </div>

                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5">
                        <div class="flex items-start justify-between gap-4">
                            <div>
                                <div class="text-sm text-neutral-400">Personen</div>
                                <div class="mt-2 text-3xl font-semibold tracking-tight" id="kpi-people">‚Äì</div>
                                <div class="mt-2 text-sm text-neutral-400">Radar: <span id="kpi-radar">‚Äì</span></div>
                            </div>
                            <div
                                class="grid h-11 w-11 place-items-center rounded-2xl border border-white/10 bg-white/5">
                                üë•</div>
                        </div>
                    </div>
                </div>

                <div class="mt-3 rounded-2xl border border-white/10 bg-white/5 p-5">
                    <div class="flex flex-wrap items-baseline justify-between gap-3">
                        <div>
                            <div class="text-lg font-semibold tracking-tight">Temperaturverlauf</div>
                            <div class="mt-1 text-sm text-neutral-400">letzte 24 Stunden</div>
                        </div>
                        <div class="text-sm text-neutral-400">Line</div>
                    </div>
                    <div class="mt-4 h-[440px]">
                        <canvas id="tempChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- VIEW: REGRESSION -->
            <section data-panel="regression" hidden>
                <div class="grid grid-cols-1 gap-3 lg:grid-cols-5">
                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5 lg:col-span-3">
                        <div class="flex flex-wrap items-baseline justify-between gap-3">
                            <div>
                                <div class="text-lg font-semibold tracking-tight">Personen & Temperatur</div>
                                <div class="mt-1 text-sm text-neutral-400">Scatter + Regressionslinie</div>
                            </div>
                            <div class="text-sm text-neutral-400">Regression</div>
                        </div>
                        <div class="mt-4 h-[460px]">
                            <canvas id="scatterChart"></canvas>
                        </div>
                    </div>

                    <div class="rounded-2xl border border-white/10 bg-white/5 p-5 lg:col-span-2">
                        <div>
                            <div class="text-lg font-semibold tracking-tight">Modell</div>
                            <div class="mt-1 text-sm text-neutral-400">Temperatur = a¬∑Personen + b</div>
                        </div>

                        <div class="mt-4 grid grid-cols-1 gap-3">
                            <div class="rounded-2xl border border-white/10 bg-black/20 p-4">
                                <div class="text-sm text-neutral-400">Steigung (a)</div>
                                <div class="mt-1 text-xl font-semibold" id="reg-a">‚Äì</div>
                            </div>
                            <div class="rounded-2xl border border-white/10 bg-black/20 p-4">
                                <div class="text-sm text-neutral-400">Intercept (b)</div>
                                <div class="mt-1 text-xl font-semibold" id="reg-b">‚Äì</div>
                            </div>
                            <div class="rounded-2xl border border-white/10 bg-black/20 p-4">
                                <div class="text-sm text-neutral-400">R¬≤</div>
                                <div class="mt-1 text-xl font-semibold" id="reg-r2">‚Äì</div>
                            </div>
                        </div>

                        <div class="mt-5 border-t border-white/10 pt-4">
                            <div class="flex items-center justify-between">
                                <div class="text-sm font-medium text-neutral-200">Vorhersagen</div>
                                <div class="text-sm text-neutral-400">0 / 60 / 120</div>
                            </div>

                            <div class="mt-3 grid grid-cols-3 gap-2">
                                <div class="rounded-2xl border border-white/10 bg-black/20 p-3 text-center">
                                    <div class="text-xs text-neutral-400">0</div>
                                    <div class="mt-1 text-base font-semibold" id="pred-0">‚Äì</div>
                                </div>
                                <div class="rounded-2xl border border-white/10 bg-black/20 p-3 text-center">
                                    <div class="text-xs text-neutral-400">60</div>
                                    <div class="mt-1 text-base font-semibold" id="pred-60">‚Äì</div>
                                </div>
                                <div class="rounded-2xl border border-white/10 bg-black/20 p-3 text-center">
                                    <div class="text-xs text-neutral-400">120</div>
                                    <div class="mt-1 text-base font-semibold" id="pred-120">‚Äì</div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </section>

        </main>
    </div>
</div>
<script defer src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}